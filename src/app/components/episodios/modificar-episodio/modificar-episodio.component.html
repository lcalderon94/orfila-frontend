<!-- src/app/components/episodios/modificar-episodio/modificar-episodio.component.html -->

<div class="contenedor-modificar-episodio" *ngIf="!mostrarBuscadorEpisodios">
  <h1>Modificar Episodio</h1>
  <p class="id-episodio">ID EPISODIO: {{ episodioId }}</p>

  <form [formGroup]="episodioForm" (ngSubmit)="guardar()">
    <mat-card>
      <mat-card-content>
        <!-- Tipo Solicitante -->
        <div>
          <mat-label>Tipo Solicitante</mat-label>
          <mat-radio-group formControlName="tipoSolicitante">
            <mat-radio-button value="juzgado">Juzgado</mat-radio-button>
            <mat-radio-button value="aseguradora">Aseguradora</mat-radio-button>
          </mat-radio-group>
        </div>

        <!-- Dirección/Subdirección -->
        <mat-form-field appearance="fill">
          <mat-label>Dirección/Subdirección</mat-label>
          <mat-select formControlName="direccionSubdireccion">
            <mat-option value="IML">IML y CCrF de Palencia, Salamanca y Valladolid</mat-option>
            <!-- Agrega más opciones si es necesario -->
          </mat-select>
        </mat-form-field>

        <!-- Tipo Organismo -->
        <mat-form-field appearance="fill">
          <mat-label>Tipo Organismo</mat-label>
          <mat-select formControlName="tipoOrganismo">
            <mat-option value="penal">Juzgado de lo Penal</mat-option>
            <!-- Agrega más opciones si es necesario -->
          </mat-select>
        </mat-form-field>

        <!-- Organismo -->
        <mat-form-field appearance="fill">
          <mat-label>Organismo</mat-label>
          <mat-select formControlName="organismo">
            <mat-option value="Jdo. de lo Penal Nº 1 de Avila (Ávila)">Jdo. de lo Penal Nº 1 de Avila (Ávila)</mat-option>
            <!-- Agrega más opciones si es necesario -->
          </mat-select>
        </mat-form-field>

        <!-- Tipo Procedimiento -->
        <mat-form-field appearance="fill">
          <mat-label>Tipo Procedimiento</mat-label>
          <mat-select formControlName="tipoProcedimiento">
            <mat-option value="ABS">ABS - Abstención / Recusación Jueces</mat-option>
            <!-- Agrega más opciones si es necesario -->
          </mat-select>
        </mat-form-field>

        <!-- Nº/Año -->
        <div class="numero-anio-container">
          <mat-form-field appearance="fill">
            <mat-label>Nº</mat-label>
            <input matInput formControlName="nAnio">
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Año</mat-label>
            <mat-select formControlName="anio">
              <mat-option value="2022">2022</mat-option>
              <mat-option value="2023">2023</mat-option>
              <!-- Agrega más opciones si es necesario -->
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Nº Atestado/Año -->
        <div class="numero-anio-container">
          <mat-form-field appearance="fill">
            <mat-label>Nº Atestado</mat-label>
            <input matInput formControlName="numeroAtestadoAnio">
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Año Atestado</mat-label>
            <mat-select formControlName="anioAtestado">
              <mat-option value="2022">2022</mat-option>
              <mat-option value="2023">2023</mat-option>
              <!-- Agrega más opciones si es necesario -->
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Fecha Hecho -->
        <mat-form-field appearance="fill">
          <mat-label>Fecha Hecho</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="fechaHecho">
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>

        <!-- NIG -->
        <div formArrayName="nig" class="nig-container">
          <mat-form-field *ngFor="let control of nigControls; let i = index" appearance="fill">
            <mat-label>NIG {{i + 1}}</mat-label>
            <input matInput [formControlName]="i">
          </mat-form-field>
          <button mat-icon-button type="button" (click)="copiarNIG()">
            <mat-icon>content_copy</mat-icon>
          </button>
        </div>

        <!-- Checkboxes -->
        <div class="checkbox-container">
          <mat-checkbox formControlName="juzgadoGuardia">Juzgado de Guardia</mat-checkbox>
          <mat-checkbox formControlName="violenciaGenero">Violencia de Género</mat-checkbox>
          <mat-checkbox formControlName="testigoProtegido">Testigo Protegido</mat-checkbox>
          <mat-checkbox formControlName="causaConPreso">Causa con Preso</mat-checkbox>
          <mat-checkbox formControlName="secretoSumario">Secreto de Sumario</mat-checkbox>
          <mat-checkbox formControlName="violenciaDomestica">Violencia Doméstica</mat-checkbox>
          <mat-checkbox formControlName="urgente">Urgente</mat-checkbox>
        </div>

        <!-- Descripción Episodio -->
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Descripción Episodio</mat-label>
          <textarea matInput formControlName="descripcionEpisodio" rows="4"></textarea>
        </mat-form-field>
      </mat-card-content>
    </mat-card>

    <!-- Botones de Acción -->
    <div class="botones-accion">
      <button mat-stroked-button type="button" (click)="volver()">ATRÁS</button>
      <button mat-raised-button color="primary" type="button" (click)="nuevoSujeto()">NUEVO SUJETO</button>
      <button mat-stroked-button type="button" (click)="notasEpisodio()">NOTAS DEL EPISODIO</button>
      <button mat-raised-button color="primary" type="submit">GUARDAR</button>
    </div>
  </form>
</div>

<div *ngIf="mostrarBuscadorEpisodios" class="buscador-episodios">
  <h2>Seleccione un Episodio para Modificar</h2>
  <mat-form-field class="full-width">
    <input type="text" placeholder="Buscar episodio" matInput [formControl]="episodioControl" [matAutocomplete]="auto">
    <mat-autocomplete #auto="matAutocomplete" (optionSelected)="seleccionarEpisodio($event.option.value)">
      <mat-option *ngFor="let episodio of episodiosFiltrados | async" [value]="episodio">
        {{ episodio.nEpisodio }} - {{ episodio.descripcionEpisodio }}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>
</div>
